<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Building a Neural Network From Scratch - The Random Forest</title><meta name="Description" content="About LoveIt Theme"><meta property="og:title" content="Building a Neural Network From Scratch" />
<meta property="og:description" content="In this project we will learn what is an artificial neural network and how it can be used to train ML models." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-12-23T08:48:18+02:00" />
<meta property="article:modified_time" content="2021-12-23T08:48:18+02:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Building a Neural Network From Scratch"/>
<meta name="twitter:description" content="In this project we will learn what is an artificial neural network and how it can be used to train ML models."/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/static/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/" /><link rel="prev" href="https://yuvi101.github.io/therandomforest.github.io/posts/dementia_prediction/" /><link rel="next" href="https://yuvi101.github.io/therandomforest.github.io/posts/spotify/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/therandomforest.github.io/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Building a Neural Network From Scratch",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/yuvi101.github.io\/therandomforest.github.io\/posts\/digit_recognition\/"
        },"image": ["https:\/\/yuvi101.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "Python, Neural Networks, Deep Learning, Linear Algebra","wordcount":  816 ,
        "url": "https:\/\/yuvi101.github.io\/therandomforest.github.io\/posts\/digit_recognition\/","datePublished": "2021-12-23T08:48:18+02:00","dateModified": "2021-12-23T08:48:18+02:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/yuvi101.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "Yuval"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/therandomforest.github.io/" title="The Random Forest"><span class="header-title-pre"><i class='fas fa-tree'></i></span>The Random Forest</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/posts/"> Posts </a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/tags/"> Tags </a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/categories/"> Categories </a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/categories/documentation/"> Docs </a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/about/"> About </a><a class="menu-item" href="/therandomforest.github.io/" title="GitHub"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/therandomforest.github.io/" title="The Random Forest"><span class="header-title-pre"><i class='fas fa-tree'></i></span>The Random Forest</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/posts/" title="">Posts</a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/tags/" title="">Tags</a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/categories/" title="">Categories</a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/categories/documentation/" title="">Docs</a><a class="menu-item" href="/therandomforest.github.io/therandomforest.github.io/about/" title="">About</a><a class="menu-item" href="/therandomforest.github.io/" title="GitHub"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Building a Neural Network From Scratch</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/therandomforest.github.io/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Yuval</a></span>&nbsp;<span class="post-category">included in <a href="/therandomforest.github.io/categories/neural-networks/"><i class="far fa-folder fa-fw"></i>Neural Networks</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2021-12-23">2021-12-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;816 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;<span id="/therandomforest.github.io/posts/digit_recognition/" class="leancloud_visitors" data-flag-title="Building a Neural Network From Scratch">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;views
                    </span>&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#what-are-neural-networks">What are neural networks?</a></li>
        <li><a href="#designing-a-neural-network-to-fit-our-needs">Designing a neural network to fit our needs</a></li>
        <li><a href="#the-math-behind">The math behind</a></li>
        <li><a href="#what-are-we-looking-for">What are we looking for?</a></li>
        <li><a href="#implementation">Implementation</a></li>
        <li><a href="#the-results">The results</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>In this project we will learn what is an artificial neural network and how it can be used to train ML models.</p>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw"></i>Note<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">Note that you might need some basic understanding of linear algebra, such as matrix multiplication.</div>
        </div>
    </div>
<p><img
        class="lazyload"
        src="/therandomforest.github.io/svg/loading.min.svg"
        data-src="https://cdn.pixabay.com/photo/2017/04/08/11/07/nerve-cells-2213009_960_720.jpg"
        data-srcset="https://cdn.pixabay.com/photo/2017/04/08/11/07/nerve-cells-2213009_960_720.jpg, https://cdn.pixabay.com/photo/2017/04/08/11/07/nerve-cells-2213009_960_720.jpg 1.5x, https://cdn.pixabay.com/photo/2017/04/08/11/07/nerve-cells-2213009_960_720.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.pixabay.com/photo/2017/04/08/11/07/nerve-cells-2213009_960_720.jpg"
        title="Neuron" /></p>
<p>To make this more practical, I will explain the theory based on a digit recognition project. You are more than welcomed to make changes to the code and see how it affects the model accuracy.<br>
<div class="details admonition quote open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-quote-right fa-fw"></i>Quote<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><strong>&ldquo;Tell me and I&rsquo;ll forget.<br>
Show me and I might remember.<br>
Involve me and I learn.&quot;</strong>     ~Benjamin Franklin</div>
        </div>
    </div></p>
<h3 id="what-are-neural-networks">What are neural networks?</h3>
<p>A typical neural network comprised of a node layers, containing an input layer, one or more hidden layers, and an output layer.
Each node from one layer connects to all the nodes from another layer by weighted links. A weight is a measure of how significant a link is.
In addition each node from the hidden and the output layers have a bias, while the weights can determine the slope of a function the bias
allows the function to shift up and down.
We can refer to this as a linear function:<br>
<img
        class="lazyload"
        src="/therandomforest.github.io/svg/loading.min.svg"
        data-src="input_output.png"
        data-srcset="input_output.png, input_output.png 1.5x, input_output.png 2x"
        data-sizes="auto"
        alt="input_output.png"
        title="input and output neurons" /></p>
<h3 id="designing-a-neural-network-to-fit-our-needs">Designing a neural network to fit our needs</h3>
<p>The data set we are going to use in this example consists of 42,000 training examples of handwritten digit images, each of size 28x28 pixels, where each pixel has a value between 0 and 255 representing the lightness and darkness of that pixel. In addition there is a label vector representing the true digit that was drawn.</p>
<p>Our network will look like this:<br>
<img
        class="lazyload"
        src="/therandomforest.github.io/svg/loading.min.svg"
        data-src="net_struct.png"
        data-srcset="net_struct.png, net_struct.png 1.5x, net_struct.png 2x"
        data-sizes="auto"
        alt="net_struct.png"
        title="network&amp;rsquo;s structure" /></p>
<ul>
<li>First layer: consists of 28x28 = 784 pixels</li>
<li>Hidden layer: consists of (I chose 16 nodes) but it could be a different number.</li>
<li>Output layer: consists of 10 nodes representing the digits 0-9.</li>
</ul>
<p>To get the activation value of the nodes in the next layer we need to perform the following calculation:
<img
        class="lazyload"
        src="/therandomforest.github.io/svg/loading.min.svg"
        data-src="activ_relu_weight.png"
        data-srcset="activ_relu_weight.png, activ_relu_weight.png 1.5x, activ_relu_weight.png 2x"
        data-sizes="auto"
        alt="activ_relu_weight.png"
        title="explenation" /></p>
<p>ReLU is an activation function, we will dive deeper into in the next section.
We have 42,000 of this images, we are going to represent in a 784x42,000 matrix, each column is a representation of an image&rsquo;s pixels values, we&rsquo;ll call it <strong>X</strong>.<br>
<strong>y</strong> is a vector of length 42,000 representing the labels.</p>
<h3 id="the-math-behind">The math behind</h3>
<p><img
        class="lazyload"
        src="/therandomforest.github.io/svg/loading.min.svg"
        data-src="calculations.png"
        data-srcset="calculations.png, calculations.png 1.5x, calculations.png 2x"
        data-sizes="auto"
        alt="calculations.png"
        title="/posts/calculations.png" /></p>
<p><img
        class="lazyload"
        src="/therandomforest.github.io/svg/loading.min.svg"
        data-src="ReLU.png"
        data-srcset="ReLU.png, ReLU.png 1.5x, ReLU.png 2x"
        data-sizes="auto"
        alt="ReLU.png"
        title="ReLU" /></p>
<h3 id="what-are-we-looking-for">What are we looking for?</h3>
<h3 id="implementation">Implementation</h3>
<p>Initializing the weight and biases matrices.<br>
n is the size of the hidden layer.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="k">def</span> <span class="nf">init_params</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">W1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">784</span><span class="p">))</span>
    <span class="n">W2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>
</code></pre></div><p>Determine the math functions described in the previous section.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># math functions</span>
<span class="k">def</span> <span class="nf">ReLU</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">Z</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">A</span>

<span class="k">def</span> <span class="nf">ReLU_deriv</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">1</span>
</code></pre></div><p>Here we make a matrix where each row is representing the digits and each representing the image&rsquo;s label.
Lets assume that the first image is 2, the first column will be [[0,0,<strong>1</strong>,0,0,0,0,0,0,0], [&hellip;] ]</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="k">def</span> <span class="nf">one_hot_converter</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
    <span class="n">one_hot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">one_hot</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">one_hot</span><span class="o">.</span><span class="n">T</span>
</code></pre></div><p><strong>Forward propagation -</strong>  The neurons in the hidden layer receives input from all the neurons in the previous layer, combines it with its own set of weights and adds the bias. After applying some activation function (ReLU), calculates the output known as &lsquo;hidden_activation&rsquo;. The output of the hidden activation will serve as input for the next layer neurons.
Similar calculations occur in the output layer except the fact that the activation function is the Softmax.</p>
<p><strong>Backward propagation -</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="k">def</span> <span class="nf">forward_propogation</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="n">hidden_layer</span> <span class="o">=</span> <span class="n">W1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">b1</span>
    <span class="n">hidden_activation</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">(</span><span class="n">hidden_layer</span><span class="p">)</span>
    <span class="n">output_layer</span> <span class="o">=</span> <span class="n">W2</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">hidden_activation</span><span class="p">)</span> <span class="o">+</span> <span class="n">b2</span>
    <span class="n">output_activation</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">output_layer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hidden_layer</span><span class="p">,</span> <span class="n">hidden_activation</span><span class="p">,</span> <span class="n">output_layer</span> <span class="p">,</span> <span class="n">output_activation</span>

<span class="k">def</span> <span class="nf">backward_propogation</span><span class="p">(</span><span class="n">hidden_layer</span><span class="p">,</span> <span class="n">hidden_activation</span><span class="p">,</span> <span class="n">output_layer</span> <span class="p">,</span> <span class="n">output_activation</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">one_hot</span> <span class="o">=</span> <span class="n">one_hot_converter</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">error_rate</span> <span class="o">=</span> <span class="n">output_activation</span> <span class="o">-</span> <span class="n">one_hot</span>
    <span class="n">W2_deriv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">error_rate</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">hidden_activation</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">b2_deriv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">error_rate</span><span class="p">)</span>
    <span class="n">hidden_layer_deriv</span> <span class="o">=</span> <span class="n">W2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">error_rate</span><span class="p">)</span> <span class="o">*</span> <span class="n">ReLU_deriv</span><span class="p">(</span><span class="n">hidden_layer</span><span class="p">)</span>
    <span class="n">W1_deriv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">hidden_layer_deriv</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">b1_deriv</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">hidden_layer_deriv</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">W1_deriv</span><span class="p">,</span> <span class="n">b1_deriv</span><span class="p">,</span> <span class="n">W2_deriv</span><span class="p">,</span> <span class="n">b2_deriv</span>

<span class="k">def</span> <span class="nf">adjust_weights_and_biases</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">W1_deriv</span><span class="p">,</span> <span class="n">b1_deriv</span><span class="p">,</span> <span class="n">W2_deriv</span><span class="p">,</span> <span class="n">b2_deriv</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">):</span>
    <span class="n">W1</span> <span class="o">=</span> <span class="n">W1</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">W1_deriv</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">b1_deriv</span>    
    <span class="n">W2</span> <span class="o">=</span> <span class="n">W2</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">W2_deriv</span>  
    <span class="n">b2</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">-</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">b2_deriv</span>    
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>
</code></pre></div><p>Applying a gradient descent algorithm to find the &lsquo;minimal point&rsquo;</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="k">def</span> <span class="nf">get_predictions</span><span class="p">(</span><span class="n">A2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">predictions</span> <span class="o">==</span> <span class="n">Y</span><span class="p">)</span> <span class="o">/</span> <span class="n">Y</span><span class="o">.</span><span class="n">size</span>
    <span class="k">return</span> <span class="n">acc</span>

<span class="k">def</span> <span class="nf">gradient_descent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
    <span class="n">acc_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">init_params</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">hidden_layer</span><span class="p">,</span> <span class="n">hidden_activation</span><span class="p">,</span> <span class="n">output_layer</span> <span class="p">,</span> <span class="n">output_activation</span> <span class="o">=</span> <span class="n">forward_propogation</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">W1_deriv</span><span class="p">,</span> <span class="n">b1_deriv</span><span class="p">,</span> <span class="n">W2_deriv</span><span class="p">,</span> <span class="n">b2_deriv</span> <span class="o">=</span> <span class="n">backward_propogation</span><span class="p">(</span><span class="n">hidden_layer</span><span class="p">,</span> <span class="n">hidden_activation</span><span class="p">,</span> <span class="n">output_layer</span> <span class="p">,</span> <span class="n">output_activation</span><span class="p">,</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">adjust_weights_and_biases</span><span class="p">(</span><span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">W1_deriv</span><span class="p">,</span> <span class="n">b1_deriv</span><span class="p">,</span> <span class="n">W2_deriv</span><span class="p">,</span> <span class="n">b2_deriv</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Iteration No: &#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">get_predictions</span><span class="p">(</span><span class="n">output_activation</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">get_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">acc_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_accuracy</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">acc_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span>


<span class="n">W1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">W2</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">gradient_descent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mi">350</span><span class="p">)</span>
</code></pre></div><h3 id="the-results">The results</h3>
<div class="echarts" id="id-1" style="width: 100%; height: 30rem;"></div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2021-12-23</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/" data-title="Building a Neural Network From Scratch" data-hashtags="Python,Neural Networks,Deep Learning,Linear Algebra"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/" data-hashtag="Python"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/" data-title="Building a Neural Network From Scratch"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/" data-title="Building a Neural Network From Scratch"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://yuvi101.github.io/therandomforest.github.io/posts/digit_recognition/" data-title="Building a Neural Network From Scratch"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/therandomforest.github.io/tags/python/">Python</a>,&nbsp;<a href="/therandomforest.github.io/tags/neural-networks/">Neural Networks</a>,&nbsp;<a href="/therandomforest.github.io/tags/deep-learning/">Deep Learning</a>,&nbsp;<a href="/therandomforest.github.io/tags/linear-algebra/">Linear Algebra</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/therandomforest.github.io/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/therandomforest.github.io/posts/dementia_prediction/" class="prev" rel="prev" title="Dementia Prediction"><i class="fas fa-angle-left fa-fw"></i>Dementia Prediction</a>
            <a href="/therandomforest.github.io/posts/spotify/" class="next" rel="next" title="Building a Spotify Recommendation System">Building a Spotify Recommendation System<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.88.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2019 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/therandomforest.github.io/" target="_blank"></a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/therandomforest.github.io/lib/valine/valine.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@13.0.0/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@4.8.0/dist/echarts.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@4.8.0/theme/macarons.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{"valine":{"appId":"QGzwQXOqs5JOhN4RGPOkR2mR-MdYXbMMI","appKey":"WBmoGyJtbqUswvfLh6L8iEBr","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"en","pageSize":10,"placeholder":"Your comment ...","recordIP":true,"serverURLs":"https://leancloud.hugoloveit.com","visitor":true}},"data":{"id-1":"{\"grid\":{\"bottom\":\"5%\",\"containLabel\":true,\"left\":\"5%\",\"right\":\"5%\",\"top\":\"20%\"},\"legend\":{\"data\":[\"Accuracy\"],\"top\":\"10%\"},\"series\":[{\"data\":[0.10819047619047618,0.4763809523809524,0.6210952380952381,0.6908095238095238,0.7338571428571429,0.7628095238095238,0.7834285714285715,0.7981190476190476,0.8107380952380953,0.8205238095238095,0.8295,0.837047619047619,0.8432142857142857,0.8493095238095238,0.8542857142857143,0.858452380952381,0.8622380952380952,0.8657380952380952,0.8691904761904762,0.8718809523809524,0.8746904761904762,0.8770476190476191,0.8788809523809524,0.8809285714285714,0.8826904761904761,0.8844047619047619,0.8865,0.8881428571428571,0.889452380952381,0.8908095238095238,0.8923095238095238,0.8933333333333333,0.8946428571428572,0.8956666666666667,0.8966428571428572],\"name\":\"Accuracy\",\"stack\":\"Total\",\"type\":\"line\"}],\"title\":{\"left\":\"center\",\"text\":\"Summary Line Chart\",\"top\":\"2%\"},\"toolbox\":{\"feature\":{\"saveAsImage\":{\"title\":\"Save as Image\"}}},\"tooltip\":{\"trigger\":\"axis\"},\"xAxis\":{\"boundaryGap\":false,\"data\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],\"type\":\"category\"},\"yAxis\":{\"type\":\"value\"}}"},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.en","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"},"twemoji":true};</script><script type="text/javascript" src="/therandomforest.github.io/js/theme.min.js"></script></body>
</html>
